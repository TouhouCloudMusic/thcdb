# User (用户) 模块

> **实现状态**: ⚠️ 部分完成 | [查看路线图](../ROADMAP.md#permission)

用户实体，代表系统中的注册用户账户和个人资料。包含权限管理和关注系统。

## 基本信息

- **Username / 用户名**: 唯一的用户标识名称
- **Password / 密码**: 加密存储的用户密码
- **Avatar / 头像**: 用户头像图片
- **Profile Banner / 个人资料横幅**: 个人主页横幅图片
- **Bio / 个人简介**: 用户的自我介绍
- **Last Login / 最后登录时间**: 用户最近一次登录的时间

## 关联关系

### 直接关联

- **comment** - 用户发表的评论
- **correction_revision** - 用户提交的修正版本
- **correction_user** - 用户参与的修正
- **user_following** - 用户关注关系
- **user_list** - 用户创建的列表
- **user_role** - 用户角色权限

## 用户角色系统

通过 `user_role` 实体管理用户权限：

### 权限级别

- **普通用户** - 基本浏览和评论权限
- **贡献者** - 可以提交修正和建议
- **编辑者** - 可以审核和批准修正
- **管理员** - 完整的系统管理权限

### 专业角色

- **音乐专家** - 特定流派或时期的专家
- **图片管理员** - 管理图片上传和审核
- **社区管理员** - 管理用户互动和内容

## 关注系统

用户可以通过 `user_following` 关注其他用户：

### 关注功能

- **关注用户** - 跟踪其他用户的活动
- **粉丝系统** - 查看谁关注了自己
- **活动流** - 查看关注用户的最新活动
- **推荐系统** - 基于关注关系的内容推荐

## 隐私和安全

### 数据保护

- **密码加密** - 安全的密码存储
- **个人信息** - 可选的个人资料信息
- **活动隐私** - 控制活动可见性

### 账户安全

- **登录追踪** - 最后登录时间记录
- **会话管理** - 安全的用户会话
- **权限控制** - 基于角色的访问控制

## API 端点

### 已实现

| 端点 | 方法 | 状态 | 说明 |
|------|------|------|------|
| `/register` | POST | ✅ | 用户注册 |
| `/login` | POST | ✅ | 用户登录 |
| `/logout` | POST | ✅ | 用户登出 |
| `/profile` | GET | ✅ | 获取个人资料 |
| `/profile` | PUT | ✅ | 更新个人资料 |
| `/avatar` | POST | ✅ | 上传头像 |
| `/profile-banner` | POST | ✅ | 上传横幅 |

### 权限管理 (待实现)

| 端点 | 方法 | 状态 | 说明 |
|------|------|------|------|
| `/admin/users` | GET | ❌ | 用户列表 |
| `/admin/user/{id}/roles` | GET | ❌ | 用户角色 |
| `/admin/user/{id}/roles` | PUT | ❌ | 修改角色 |
| `/roles` | GET | ❌ | 可用角色列表 |

### 关注系统 (待实现)

| 端点 | 方法 | 状态 | 说明 |
|------|------|------|------|
| `/user/{id}/follow` | POST | ❌ | 关注用户 |
| `/user/{id}/unfollow` | POST | ❌ | 取消关注 |
| `/user/{id}/following` | GET | ❌ | 关注列表 |
| `/user/{id}/followers` | GET | ❌ | 粉丝列表 |
| `/user/{id}/follow-status` | GET | ❌ | 关注状态 |
| `/feed` | GET | ❌ | 活动流 |
